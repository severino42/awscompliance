# This tool gets volume and ec2 data from an AWS account and outputs a report for compliance.

Here is an example of the raw data

1. an EC2 instance
>>> pp.pprint(response["Reservations"][0])
{ 'Groups': [],
  'Instances': [ { 'AmiLaunchIndex': 0,
                   'Architecture': 'x86_64',
                   'BlockDeviceMappings': [ { 'DeviceName': '/dev/sda1',
                                              'Ebs': { 'AttachTime': datetime.datetime(2015, 5, 28, 23, 31, 52, tzinfo=tzutc()),
                                                       'DeleteOnTermination': True,
                                                       'Status': 'attached',
                                                       'VolumeId': 'vol-68d26f78'}},
                                            { 'DeviceName': 'xvdf',
                                              'Ebs': { 'AttachTime': datetime.datetime(2015, 5, 28, 23, 31, 52, tzinfo=tzutc()),
                                                       'DeleteOnTermination': False,
                                                       'Status': 'attached',
                                                       'VolumeId': 'vol-aed26fbe'}}],
                   'CapacityReservationSpecification': { 'CapacityReservationPreference': 'open'},
                   'ClientToken': 'rEzDc1432855908752',
                   'CpuOptions': {'CoreCount': 4, 'ThreadsPerCore': 2},
                   'EbsOptimized': True,
                   'EnaSupport': True,
                   'EnclaveOptions': {'Enabled': False},
                   'HibernationOptions': {'Configured': False},
                   'Hypervisor': 'xen',
                   'IamInstanceProfile': { 'Arn': 'arn:aws:iam::414502572119:instance-profile/ec2_devwin02',
                                           'Id': 'AIPAJCG6GHD6R4ICEX2XQ'},
                   'ImageId': 'ami-0f122d3f',
                   'InstanceId': 'i-bc2fb64b',
                   'InstanceType': 'c5d.2xlarge',
                   'KeyName': 'paulkeypair',
                   'LaunchTime': datetime.datetime(2022, 3, 10, 20, 44, 45, tzinfo=tzutc()),
                   'MaintenanceOptions': {'AutoRecovery': 'default'},
                   'MetadataOptions': { 'HttpEndpoint': 'enabled',
                                        'HttpProtocolIpv6': 'disabled',
                                        'HttpPutResponseHopLimit': 1,
                                        'HttpTokens': 'optional',
                                        'InstanceMetadataTags': 'disabled',
                                        'State': 'applied'},
                   'Monitoring': {'State': 'enabled'},
                   'NetworkInterfaces': [ { 'Association': { 'IpOwnerId': '414502572119',
                                                             'PublicDnsName': 'ec2-54-149-31-179.us-west-2.compute.amazonaws.com',
                                                             'PublicIp': '54.149.31.179'},
                                            'Attachment': { 'AttachTime': datetime.datetime(2015, 5, 28, 23, 31, 49, tzinfo=tzutc()),
                                                            'AttachmentId': 'eni-attach-fd2a4fd3',
                                                            'DeleteOnTermination': True,
                                                            'DeviceIndex': 0,
                                                            'NetworkCardIndex': 0,
                                                            'Status': 'attached'},
                                            'Description': 'Primary network '
                                                           'interface',
                                            'Groups': [ { 'GroupId': 'sg-0565575d5d42b0750',
                                                          'GroupName': 'ci-master'},
                                                        { 'GroupId': 'sg-880efdef',
                                                          'GroupName': 'RPCAccessToWebServerSG'},
                                                        { 'GroupId': 'sg-0ab7451283169c359',
                                                          'GroupName': 'dev-web-server'}],
                                            'InterfaceType': 'interface',
                                            'Ipv6Addresses': [],
                                            'MacAddress': '02:b3:fd:ac:ea:59',
                                            'NetworkInterfaceId': 'eni-92d658f5',
                                            'OwnerId': '414502572119',
                                            'PrivateDnsName': 'ip-10-0-2-165.us-west-2.compute.internal',
                                            'PrivateIpAddress': '10.0.2.165',
                                            'PrivateIpAddresses': [ { 'Association': { 'IpOwnerId': '414502572119',
                                                                                       'PublicDnsName': 'ec2-54-149-31-179.us-west-2.compute.amazonaws.com',
                                                                                       'PublicIp': '54.149.31.179'},
                                                                      'Primary': True,
                                                                      'PrivateDnsName': 'ip-10-0-2-165.us-west-2.compute.internal',
                                                                      'PrivateIpAddress': '10.0.2.165'}],
                                            'SourceDestCheck': True,
                                            'Status': 'in-use',
                                            'SubnetId': 'subnet-7cd3ea15',
                                            'VpcId': 'vpc-7e704917'}],
                   'Placement': { 'AvailabilityZone': 'us-west-2b',
                                  'GroupName': '',
                                  'Tenancy': 'default'},
                   'Platform': 'windows',
                   'PlatformDetails': 'Windows',
                   'PrivateDnsName': 'ip-10-0-2-165.us-west-2.compute.internal',
                   'PrivateDnsNameOptions': {},
                   'PrivateIpAddress': '10.0.2.165',
                   'ProductCodes': [],
                   'PublicDnsName': 'ec2-54-149-31-179.us-west-2.compute.amazonaws.com',
                   'PublicIpAddress': '54.149.31.179',
                   'RootDeviceName': '/dev/sda1',
                   'RootDeviceType': 'ebs',
                   'SecurityGroups': [ { 'GroupId': 'sg-0565575d5d42b0750',
                                         'GroupName': 'ci-master'},
                                       { 'GroupId': 'sg-880efdef',
                                         'GroupName': 'RPCAccessToWebServerSG'},
                                       { 'GroupId': 'sg-0ab7451283169c359',
                                         'GroupName': 'dev-web-server'}],
                   'SourceDestCheck': True,
                   'State': {'Code': 16, 'Name': 'running'},
                   'StateTransitionReason': '',
                   'SubnetId': 'subnet-7cd3ea15',
                   'Tags': [{'Key': 'Name', 'Value': 'devwin02'}],
                   'UsageOperation': 'RunInstances:0002',
                   'UsageOperationUpdateTime': datetime.datetime(2015, 5, 28, 23, 31, 49, tzinfo=tzutc()),
                   'VirtualizationType': 'hvm',
                   'VpcId': 'vpc-7e704917'}],
  'OwnerId': '414502572119',
  'ReservationId': 'r-26b4a02c'}

2. A volume
>>> pp.pprint(vols[0])   
{ 'Attachments': [ { 'AttachTime': datetime.datetime(2020, 9, 25, 18, 52, 55, tzinfo=tzutc()),
                     'DeleteOnTermination': True,
                     'Device': '/dev/xvdf',
                     'InstanceId': 'i-064c7a82427226773',
                     'State': 'attached',
                     'VolumeId': 'vol-07ff5bc9cd0f36914'}],
  'AvailabilityZone': 'us-west-2d',
  'CreateTime': datetime.datetime(2020, 9, 25, 18, 52, 55, 330000, tzinfo=tzutc()),
  'Encrypted': False,
  'Iops': 100,
  'MultiAttachEnabled': False,
  'Size': 4,
  'SnapshotId': 'snap-0ccde7da6afffe8ed',
  'State': 'in-use',
  'Tags': [ {'Key': 'Application', 'Value': 'bitc'},
            {'Key': 'Environment', 'Value': 'bitc:prod'}],
  'VolumeId': 'vol-07ff5bc9cd0f36914',
  'VolumeType': 'gp2'}
>>> 
